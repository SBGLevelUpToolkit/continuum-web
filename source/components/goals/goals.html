<div md-theme="continuumDark" layout="column" flex layout-align="start center">
    <!--<img src="images/logo.png" style="max-width:300px; max-height:300px;"/>-->

    <div class="layout-content" layout="row" layout-fill="" layout-align="center center">
        <md-content class="feature-panel" flex="40" style="position: relative;">
            <img ng-show="ctrl.loading" src="images/loading.gif" style="position: absolute; left: 95px; top: 65px"/>

            <div layout layout-align="center center">
                <div class="line" flex></div>
                <div class="text">GOALS</div>
                <div class="line" flex></div>
            </div>
            <div layout flex layout-align="center center" class="top-spacer">
                View and create goals for your team
            </div>
            <div class="top-spacer"></div>
            <table width="100%">
                <tr>
                    <th>Dimension</th>
                    <th>Capability</th>
                    <th>Notes</th>
                    <th>DueDate</th>
                    <th>Completed</th>
                </tr>
                <tr ng-repeat="goal in ctrl.goals">
                    <td>{{goal.Dimension}}</td>
                    <td>{{goal.Capability}}</td>
                    <td>{{goal.Notes}}</td>
                    <td>{{goal.DueDate}}</td>
                    <td>{{goal.Completed}}</td>
                </tr>
            </table>
            <div class="top-spacer"></div>
            <form id="form" name="ctrl.form" novalidate>
                <div layout="column">
                    <md-autocomplete flex class="form-field"
                                     ng-disabled="ctrl.isDisabled"
                                     md-no-cache="ctrl.noCache"
                                     md-selected-item="ctrl.goal.selectedDimension"
                                     md-search-text="ctrl.searchTextDimension"
                                     md-search-text-change="ctrl.searchTextChange(ctrl.searchTextDimension, ctrl.selectedDimension)"
                                     md-selected-item-change="ctrl.selectedItemChange(item)"
                                     md-items="item in ctrl.querySearch(ctrl.searchTextDimension, ctrl.dimensions)"
                                     md-item-text="item.Name"
                                     md-min-length="0"
                                     placeholder="Select a dimension"
                                     md-menu-class="autocomplete-custom-template">
                        <md-item-template>
                            <span md-highlight-text="ctrl.searchTextDimension" md-highlight-flags="^i">{{item.Name}}</span>
                        </md-item-template>
                        <md-not-found>
                            No matches found for "{{ctrl.searchTextDimension}}".
                        </md-not-found>
                    </md-autocomplete>
                    <!-- This has to remain until mdAutoComplete bugs are fixed and it displays validation errors correctly -->
                    <md-input-container>
                        <input ng-hide="true" type="password" name="dimensionValidation" ng-model="ctrl.goal.selectedDimension" required>

                        <div ng-messages="ctrl.form.dimensionValidation.$error">
                            <div ng-show="ctrl.form.$submitted || ctrl.form.dimensionValidation.$touched">
                                <div ng-message="required">This is required.</div>
                            </div>
                        </div>
                    </md-input-container>

                    <md-autocomplete flex class="form-field"
                                     ng-disabled="ctrl.isDisabled"
                                     md-no-cache="ctrl.noCache"
                                     md-selected-item="ctrl.goal.selectedCapability"
                                     md-search-text="ctrl.searchTextCapability"
                                     md-search-text-change="ctrl.searchTextChange(ctrl.searchTextCapability)"
                                     md-items="item in ctrl.querySearch(ctrl.searchTextCapability, ctrl.fullDimension.Capabilities, 'Description')"
                                     md-item-text="item.Description"
                                     md-min-length="0"
                                     placeholder="Select a goal"
                                     md-menu-class="autocomplete-custom-template">
                        <md-item-template>
                            <span md-highlight-text="ctrl.searchTextCapability" md-highlight-flags="^i">{{item.Description}}</span>
                        </md-item-template>
                        <md-not-found>
                            No matches found for "{{ctrl.searchTextCapability}}".
                        </md-not-found>
                    </md-autocomplete>
                    <!-- This has to remain until mdAutoComplete bugs are fixed and it displays validation errors correctly -->
                    <md-input-container>
                        <input ng-hide="true" type="password" name="capabilityValidation" ng-model="ctrl.goal.selectedCapability" required>

                        <div ng-messages="ctrl.form.capabilityValidation.$error">
                            <div ng-show="ctrl.form.$submitted || ctrl.form.capabilityValidation.$touched">
                                <div ng-message="required">This is required.</div>
                            </div>
                        </div>
                    </md-input-container>

                    <div class="errorMessage" ng-show="ctrl.formInvalid">An error occurred.</div>
                    <div class="top-spacer"></div>
                    <div layout="row" layout-align="space-between center">
                        <md-input-container flex="50">
                            <label>Notes</label>
                            <textarea ng-model="ctrl.goal.notes" columns="1" md-maxlength="150"></textarea>
                        </md-input-container>
                        <md-input-container>
                            <label>Date</label>
                            <input type="date" id="date" name="date" ng-model="ctrl.goal.date" required>
                            <div ng-messages="ctrl.form.date.$error">
                                <div ng-show="ctrl.form.$submitted || ctrl.form.date.$touched">
                                    <div ng-message="required">This is required.</div>
                                    <!--<div ng-message="date">Invalid date.</div>-->
                                </div>
                            </div>
                        </md-input-container>
                    </div>
                    <div class="vertical-spacer"></div>
                    <div layout="row" layout-align="center center">
                        <md-button class="md-raised" ng-click="form.$valid && ctrl.addGoal(ctrl.goal)"
                                   style="font-weight: bold">CREATE GOAL
                        </md-button>
                    </div>
                </div>
            </form>
        </md-content>
    </div>
</div>